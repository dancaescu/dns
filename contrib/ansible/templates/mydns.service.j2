[Unit]
Description=MyDNS Authoritative DNS Server
Documentation=man:mydns(8)
After=network.target mysql.service
Wants=network-online.target

[Service]
Type=forking
User={{ mydns_user }}
Group={{ mydns_group }}
ExecStartPre=/bin/mkdir -p /run/mydns
ExecStartPre=/bin/chown {{ mydns_user }}:{{ mydns_group }} /run/mydns
ExecStart=/usr/sbin/mydns -b
ExecReload=/bin/kill -HUP $MAINPID
PIDFile=/run/mydns/mydns.pid
Restart=on-failure
RestartSec=10
TimeoutStopSec=30

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/run/mydns
CapabilityBoundingSet=CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
